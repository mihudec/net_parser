import unittest

from net_parser.ops.fortinet.FortinetOpsParser import *

from tests import BaseNetParserTest


TEST_STRING = """
B>* 0.0.0.0/0 [200/0] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 1.1.1.1/32 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 2.2.2.2/32 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 3.3.3.3/32 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.0.0.0/8 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.0.0.0/22 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.0.0.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.4.0.0/16 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.8.0.56/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.8.4.0/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.8.4.40/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.8.4.72/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.8.4.80/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.8.4.88/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.8.4.96/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.8.4.104/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.8.4.128/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.8.4.144/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.8.4.152/29 [200/1] via 10.104.0.1, VLAN-2000, 17:47:56
B>* 10.8.4.160/29 [200/1] via 10.104.0.1, VLAN-2000, 17:48:08
B>* 10.9.192.0/24 [200/0] via 10.104.0.1, VLAN-2000, 26w4d18h
B>* 10.9.193.0/24 [200/0] via 10.104.0.1, VLAN-2000, 26w4d18h
B>* 10.9.194.0/24 [200/0] via 10.104.0.1, VLAN-2000, 26w4d18h
B>* 10.9.195.0/24 [200/0] via 10.104.0.1, VLAN-2000, 26w4d18h
B>* 10.64.0.0/16 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.64.1.252/30 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.65.0.0/16 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.65.1.252/30 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.67.0.1/32 [200/0] via 10.104.0.1, VLAN-2000, 26w4d18h
B>* 10.67.0.2/32 [200/0] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.88.0.0/16 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.88.0.0/20 [200/0] via 10.104.0.1, VLAN-2000, 09w3d03h
B>* 10.88.15.192/26 [200/0] via 10.104.0.1, VLAN-2000, 09w3d03h
B>* 10.88.15.194/32 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.88.240.0/24 [200/0] via 10.104.0.1, VLAN-2000, 09w3d03h
B>* 10.88.255.0/29 [200/0] via 10.104.0.1, VLAN-2000, 09w3d03h
B>* 10.96.0.0/16 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.96.254.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.101.0.0/16 [200/0] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.102.0.0/16 [200/0] via 10.104.0.1, VLAN-2000, 26w4d18h
B>* 10.103.0.0/16 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.104.0.0/16 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
C>* 10.104.0.0/24 is directly connected, VLAN-2000
B>* 10.105.0.0/16 [200/0] via 10.104.0.1, VLAN-2000, 07w5d00h
B>* 10.108.0.38/32 [200/0] via 10.104.0.1, VLAN-2000, 03:35:55
B>* 10.108.0.40/32 [200/0] via 10.104.0.1, VLAN-2000, 26w4d18h
B>* 10.108.0.42/32 [200/0] via 10.104.0.1, VLAN-2000, 01w0d01h
B>* 10.108.0.44/32 [200/0] via 10.104.0.1, VLAN-2000, 00:32:36
B>* 10.108.0.52/32 [200/0] via 10.104.0.1, VLAN-2000, 02w2d14h
B>* 10.108.0.53/32 [200/0] via 10.104.0.1, VLAN-2000, 02w1d07h
B>* 10.110.0.0/16 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.111.0.0/16 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.112.0.0/16 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.114.1.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.126.0.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.127.0.0/16 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.0.0/22 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.4.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.10.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.12.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.14.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.16.0/20 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.32.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.40.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.41.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.41.16/32 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.41.17/32 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.42.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.64.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.66.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.130.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.130.64/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.130.128/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.131.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.140.0/22 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.144.0/22 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.147.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.201.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.202.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.206.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.210.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.212.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.230.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.232.0/24 [200/0] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.244.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.245.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.246.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.248.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.250.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.251.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.252.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.253.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.254.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.255.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.128.255.0/28 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.129.0.0/16 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.129.0.0/22 [200/0] via 10.104.0.1, VLAN-2000, 26w4d18h
B>* 10.129.104.0/24 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.129.140.0/22 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.129.144.0/22 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.129.210.0/23 [200/0] via 10.104.0.1, VLAN-2000, 26w4d18h
B>* 10.130.0.0/16 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.130.0.0/22 [200/0] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.130.16.0/20 [200/0] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.130.31.0/24 [200/0] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.130.32.0/24 [200/0] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.130.66.0/24 [200/0] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.130.210.0/23 [200/0] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.130.254.0/24 [200/0] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.130.255.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.131.0.0/22 [200/0] via 10.104.0.1, VLAN-2000, 09w3d03h
B>* 10.131.0.1/32 [200/0] via 10.104.0.1, VLAN-2000, 09w3d03h
B>* 10.131.16.0/20 [200/0] via 10.104.0.1, VLAN-2000, 09w3d03h
B>* 10.131.16.1/32 [200/0] via 10.104.0.1, VLAN-2000, 09w3d03h
B>* 10.131.32.0/24 [200/0] via 10.104.0.1, VLAN-2000, 09w3d03h
B>* 10.131.66.0/24 [200/0] via 10.104.0.1, VLAN-2000, 09w3d03h
B>* 10.131.210.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.131.232.0/24 [200/0] via 10.104.0.1, VLAN-2000, 09w3d03h
B>* 10.131.254.0/24 [200/0] via 10.104.0.1, VLAN-2000, 09w3d03h
B>* 10.131.255.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.132.0.0/16 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.0.0/22 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.0.1/32 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.4.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.4.1/32 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.16.0/20 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.16.1/32 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.32.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.32.1/32 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.40.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.40.1/32 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.41.0/24 [200/0] via 10.104.0.1, VLAN-2000, 21w0d20h
B>* 10.132.42.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.42.1/32 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.66.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.98.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.104.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.104.1/32 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.128.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.129.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.130.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.192.0/22 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.196.0/22 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.201.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.201.1/32 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.208.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.209.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.209.1/32 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.210.0/23 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.232.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.240.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.244.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.246.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.248.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.249.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.250.0/30 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.252.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.253.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.254.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.132.255.0/24 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.133.0.0/22 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.134.0.0/22 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.134.8.0/21 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.134.8.0/22 [200/0] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.134.16.0/24 [200/0] via 10.104.0.1, VLAN-2000, 09w3d03h
B>* 10.134.16.1/32 [200/0] via 10.104.0.1, VLAN-2000, 09w3d03h
B>* 10.134.24.0/21 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.134.24.0/22 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.134.24.1/32 [200/0] via 10.104.0.1, VLAN-2000, 41w4d21h
B>* 10.134.72.0/21 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.134.88.0/21 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.134.128.0/22 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.134.130.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.134.130.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.134.136.0/21 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.134.138.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.134.152.0/21 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.134.154.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.135.0.0/16 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.2.0/24 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.136.2.1/32 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.136.3.0/26 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.136.3.248/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.4.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.5.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.5.248/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.6.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.7.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.7.248/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.8.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.9.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.9.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.9.64/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.9.248/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.10.0/24 [200/0] via 10.104.0.1, VLAN-2000, 02w4d20h
B>* 10.136.10.1/32 [200/0] via 10.104.0.1, VLAN-2000, 02w4d20h
B>* 10.136.11.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.11.248/29 [200/0] via 10.104.0.1, VLAN-2000, 02w4d20h
B>* 10.136.12.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.13.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.13.64/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.13.248/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.14.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.15.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.15.248/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.16.0/24 [200/1] via 10.104.0.1, VLAN-2000, 01w5d16h
B>* 10.136.17.0/26 [200/1] via 10.104.0.1, VLAN-2000, 01w5d16h
B>* 10.136.17.248/29 [200/1] via 10.104.0.1, VLAN-2000, 01w5d16h
B>* 10.136.18.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.19.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.19.248/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.20.0/24 [200/0] via 10.104.0.1, VLAN-2000, 02w3d00h
B>* 10.136.20.1/32 [200/0] via 10.104.0.1, VLAN-2000, 02w3d00h
B>* 10.136.21.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.21.248/29 [200/1] via 10.104.0.1, VLAN-2000, 1d04h13m
B>* 10.136.24.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.25.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.25.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.25.248/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.66.0/24 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.136.66.1/32 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.136.68.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.70.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.72.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.73.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.74.0/24 [200/0] via 10.104.0.1, VLAN-2000, 02w4d20h
B>* 10.136.74.1/32 [200/0] via 10.104.0.1, VLAN-2000, 02w4d20h
B>* 10.136.76.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.78.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.80.0/24 [200/1] via 10.104.0.1, VLAN-2000, 01w5d16h
B>* 10.136.82.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.84.0/24 [200/0] via 10.104.0.1, VLAN-2000, 02w3d00h
B>* 10.136.84.1/32 [200/0] via 10.104.0.1, VLAN-2000, 02w3d00h
B>* 10.136.88.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.89.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.136.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.136.128/25 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.140.128/25 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.152.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.152.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.194.64/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.196.64/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.198.64/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.200.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.200.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.200.64/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.204.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.204.64/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.206.64/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.208.64/26 [200/1] via 10.104.0.1, VLAN-2000, 01w5d16h
B>* 10.136.212.64/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.216.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.136.216.64/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.137.4.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.137.10.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.137.11.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.137.11.248/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.137.22.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.137.24.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.137.26.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.137.28.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.137.30.0/23 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.137.74.0/24 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.138.0.0/24 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.138.0.1/32 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.138.1.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.138.1.64/26 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.138.1.65/32 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.138.1.240/29 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.138.1.241/32 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.138.1.248/29 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.138.2.0/24 [200/0] via 10.104.0.1, VLAN-2000, 23w5d20h
B>* 10.138.2.1/32 [200/0] via 10.104.0.1, VLAN-2000, 23w5d20h
B>* 10.138.3.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.138.3.64/26 [200/0] via 10.104.0.1, VLAN-2000, 23w5d20h
B>* 10.138.3.65/32 [200/0] via 10.104.0.1, VLAN-2000, 23w5d20h
B>* 10.138.3.240/29 [200/1] via 10.104.0.1, VLAN-2000, 02w5d23h
B>* 10.138.3.248/29 [200/0] via 10.104.0.1, VLAN-2000, 23w5d20h
B>* 10.138.4.0/24 [200/0] via 10.104.0.1, VLAN-2000, 07w5d00h
B>* 10.138.4.1/32 [200/0] via 10.104.0.1, VLAN-2000, 07w5d00h
B>* 10.138.5.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.138.5.64/26 [200/0] via 10.104.0.1, VLAN-2000, 07w5d00h
B>* 10.138.5.65/32 [200/0] via 10.104.0.1, VLAN-2000, 07w5d00h
B>* 10.138.5.240/29 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.138.5.248/29 [200/0] via 10.104.0.1, VLAN-2000, 07w5d00h
B>* 10.138.6.0/24 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.138.6.1/32 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.138.7.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.138.7.64/26 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.138.7.65/32 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.138.7.240/29 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.138.7.244/32 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.138.7.248/29 [200/0] via 10.104.0.1, VLAN-2000, 26w4d19h
B>* 10.138.8.0/24 [200/0] via 10.104.0.1, VLAN-2000, 37w5d22h
B>* 10.138.8.1/32 [200/0] via 10.104.0.1, VLAN-2000, 37w5d22h
B>* 10.138.9.0/26 [200/1] via 10.104.0.1, VLAN-2000, 03w2d06h
B>* 10.138.9.64/26 [200/0] via 10.104.0.1, VLAN-2000
"""


class TestFortinetOpsParser(BaseNetParserTest):

    def test_01_init(self):
        parser1 = FortinetOpsParser(command='get router info routing-table all')
        parser1.logger.info("FortinetRoutingTableParser came to life")
        self.assertEqual(parser1.logger.name, 'FortinetRoutingTableParser')

        parser2 = FortinetOpsParser(command='get system interface')
        print(parser2)
        parser2.logger.info("FortinetInterfaceParser came to life")
        self.assertEqual(parser2.logger.name, 'FortinetInterfaceParser')

    def test_02_routing_table_parse(self):
        parser = FortinetOpsParser(command='get router info routing-table all')
        routes = parser.parse(text=TEST_STRING)
        for route in routes:
            if route.prefix.prefixlen in [0, 32]:
                continue
            print(f"{route.prefix},active")

del BaseNetParserTest

if __name__ == '__main__':
    unittest.main()
